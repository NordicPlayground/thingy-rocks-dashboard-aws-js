class Globe{constructor(e){var t=new Sidebar,o=this.initViewer();this.configScene(o);this.addPoints(o,e,t),this.clickAction(o,t),o.scene.postRender.addEventListener((function(e){1==o.scene.globe.tilesLoaded&&document.querySelector(".intro-container")&&!document.querySelector(".intro-container").classList.contains("globe-rendered")&&(document.querySelector(".intro-container").classList.add("globe-rendered"),document.querySelector(".message").innerHTML="Click Anywhere to Begin.")}))}configScene(e){e.scene.screenSpaceCameraController.enableTilt=!1,document.querySelector("#zoom-out").addEventListener("click",(function(){var t=e.scene.globe.ellipsoid.cartesianToCartographic(e.camera.position).height,o=t<3e5?t/15:t/5;console.log(t),e.camera.moveBackward(o)})),document.querySelector("#zoom-in").addEventListener("click",(function(){var t=e.scene.globe.ellipsoid.cartesianToCartographic(e.camera.position).height,o=t<3e5?t/15:t/5;console.log(t),e.camera.moveForward(o)}))}initViewer(){var e=Cesium.createDefaultImageryProviderViewModels();return new Cesium.Viewer("cesiumContainer",{imageryProviderViewModels:e,selectedImageryProviderViewModel:e[1]})}addPoints(e,t,o){var i=document.querySelector(".device-list");if(Object.keys(t).length>1)for(const r in t)console.log(typeof t[r]),this.addPoint(e,t[r],i,o)}addPoint(e,t,o,i){console.log(t.position);let r=null!=t.properties.coords,a=this.createListEntry(e,t,o),n=e.entities.add({position:Cesium.Cartesian3.fromDegrees(t.position[1],t.position[0]),properties:{name:t.properties.name,coords:t.properties.coords,list_entry:a,data:t.properties.data,timestamps:t.properties.timestamp},billboard:{height:32,width:32,image:"assets/img/nordic-icon-g.svg",show:r}});a.addEventListener("click",(function(){e.selectedEntity=n,window.innerWidth<771&&i.closeSidebar()}))}createListEntry(e,t,o){let i=document.createElement("li");return i.innerHTML='<a href="#" class="'+t.properties.connected+'">'+t.properties.name+"</a>",o.appendChild(i),i}clickAction(e,t){e.selectedEntityChanged.addEventListener((function(){if(document.querySelector(".infobox")&&document.querySelector(".infobox").remove(),console.log(e),Globe.resetIcons(e),void 0!==e.selectedEntity){console.log(e.selectedEntity),Globe.populateSidebar(e.selectedEntity),Globe.populateMobileData(e.selectedEntity),e.selectedEntity.billboard.image="assets/img/nordic-icon-y.svg";var o=e.selectedEntity._properties._list_entry._value;void 0!==o&&(null!==document.querySelector(".device-list li.active")&&document.querySelector(".device-list li.active").classList.remove("active"),o.classList.add("active")),console.log(e.selectedEntity._position._value),e.flyTo(e.selectedEntity,{offset:new Cesium.HeadingPitchRange(0,-90,5e3)}),window.innerWidth>770?t.openSidebar():document.querySelector(".mobile-sidebar").classList.add("reveal")}else t.closeSidebar(),t.closeMobileSidebar()}))}static populateSidebar(e){var t=e._properties,o=document.querySelector(".data-display"),i=o.querySelector(".device-location-name-label"),r=o.querySelector(".coordinates"),a=o.querySelector(".device-data");if(i.innerHTML=t._name,r.innerHTML=null==t._coords._value?"No GPS Data Available":t._coords,void 0!==t._data._value){for(;document.querySelector(".device-data").firstChild;)a.removeChild(document.querySelector(".device-data").firstChild);console.log(t._data._value),console.log(t._timestamps._value);for(const e in t._data._value){var n=new DeviceDatum(e,t._data._value[e],t._timestamps._value[e]).returnNode();a.appendChild(n)}}}static populateMobileData(e){var t=e._properties,o=document.querySelector(".mobile-sidebar .data-display"),i=o.querySelector(".device-location-name-label"),r=o.querySelector(".coordinates"),a=o.querySelector(".mobile-sidebar .device-data");if(i.innerHTML=t._name,r.innerHTML=null==t._coords._value?"No GPS Data Available":t._coords,void 0!==t._data._value){for(;document.querySelector(".mobile-sidebar .device-data").firstChild;)a.removeChild(document.querySelector(".mobile-sidebar .device-data").firstChild);console.log(t._data._value);for(const e in t._data._value){var n=new DeviceDatum(e,t._data._value[e],t._timestamps._value[e]).returnNode();a.appendChild(n)}}}static resetIcons(e){console.log("resetIcons running");var t=e.entities._entities._array;if(console.log(t),void 0!==e.selectedEntity)for(let e=0;e<t.length;e++)void 0!==t[e]._billboard._image&&(t[e].billboard.image="assets/img/nordic-icon-g.svg")}}